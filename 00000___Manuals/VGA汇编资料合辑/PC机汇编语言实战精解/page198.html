<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<title>第7章 文件控制块</title>
</head>

<body>
<style type="text/css">
body {
	background-color: #c0c0c0;
}

table {
	background-color: #c0c0c0;
	line-height: 24px;
}
</style>
<!导航条>
<p><a href="content1.html">目录</a> <a href="page197.html">上一页</a> <a href="page199.html">下一页</a> <a href="page207.html">下一章</a></p>
<table 	border=0 align="center" width=800 frame="box" rules="none">
<!标尺行>
<tr>
<td width=3%></td><td width=6%></td><td width=1%></td>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=1%></td><td width=6%></td><td width=3%></td>
</tr>
<!页眉行>
<tr height=60 valign="bottom">
<td></td><td>-198-</td><td></td> <!页码>
<td colspan=6>PC机汇编语言实战精解</td><td colspan=4></td><td colspan=6 align="right"><img src="icons/flag.gif"></td> <!书名>
<td></td><td></td><td></td> <!右侧空白>
</tr>
<!页眉线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!正文>
<font face="宋体" lang="ZH-CN" size=3>
<tr height=20><td colspan=22></td></tr> <!顶部空白>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
度。在前面我们曾经用直接修改FCB中文件长度数值的方法改变文件长度，这种方法不太好，现在我们将使用随机块写功能调整文件长度：
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=4>g=4b 68[Enter]</td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2>AX=2800</td><td colspan=2>BX=0025</td><td colspan=2>CX=0006</td><td colspan=2>DX=0025</td><td colspan=2>SP=0000</td><td colspan=2>BP=0000</td><td colspan=2>SI=0000</td><td colspan=2>DI=0000</td><td colspan=2></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2>DS=15F1</td><td colspan=2>ES=15E1</td><td colspan=2>SS=15F1</td><td colspan=2>CS=15F6</td><td colspan=2>IP=0068</td>
<td colspan=5>NV UP EI PL ZR NA PE NC</td><td colspan=3></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2>15F6:0068</td><td colspan=2>B410</td><td colspan=6>MOV AH,10</td><td colspan=4></td><td colspan=4></td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　调整的方法也不难，首先设置目标文件的随机记录号等于源文件的长度，并且将目标文件的记录长度设为1字节，然后我们向目标文件中写入0个记录，这样就可以修改目标文件的长度。
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=8>-d25 4a[Enter]</td><td colspan=4></td><td colspan=4></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2>15F1:0020</td><td colspan=10>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;03 43 4F-4E 46 49 47 20 20 54 58</td><td></td><td colspan=5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.CONFIG&nbsp;&nbsp;TX</td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2>15F1:0030</td><td colspan=10>54 05 00 01 00 <u>9B 02</u> 00-00 54 21 9D 4B 40 02 02</td><td></td><td colspan=5>T........T!.K@..</td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2>15F1:0040</td><td colspan=10>59 07 60 B8 0F 1B 9B 02-00 00 00</td><td></td><td colspan=5>Y.`........</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　调整后文件长度为29BH，恰好等于源文件长度。注意一下FCB中还有哪些数据发生了变化。<br>
　　执行完所有的程序，返回DOS，看一看当前目录下是否有CONFIG.TXT文件，并检查其内容。<br>
　　通过这几个程序例我想大家对FCB的随机存取功能已经有了相当的了解。下一节我们将结束对FCB的讨论。
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18><font face="黑体"><a name="74">7．4 FCB完结篇</a></font></td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　这一节我们要讨论有关FCB的一些较为特殊的应用，主要是三个方面的内容：一是应用FCB删除文件和给文件改名；其二是利用扩展FCB访问具有特殊属性的文件。第三是有关"命令行参数"的问题。我们先来讨论第一个问题--删除与改名。
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=2><img src="icons/note.gif"></td>
<td colspan=2>
功能号：<br>
用　途：<br>
参　数：<br>
调　用：<br>
返　回：<br>
<br>
</td>
<td colspan=6>
13H<br>
删除文件<br>
DS:DX--指向未打开的FCB<br>
INT 21H<br>
AL = 0--文件正确删除<br>
AL = 0FFH--文件未能删除
</td>
<td></td>
<td colspan=2>
功能号：<br>
用　途：<br>
参　数：<br>
调　用：<br>
返　回：<br>
<br>
</td>
<td colspan=6>
17H<br>
文件改名<br>
DS:DX--指向特殊的FCB<br>
INT 21H<br>
AL = 0--文件正确改名<br>
AL = 0FFH--文件未能改名
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　这两个功能在应用时应注意这样几点：首先要注意它们所使用的FCB的性质，13H功能要求使用一个未打开的FCB，17H功能使用一个特殊的FCB。下面我们就来看看特殊的FCB是一种什么结构，请看图7-4：
</td>
<td></td><td></td> <!右边距>
</tr>

</font>

<!页脚线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!页脚>
<tr height=60 valign="top">
<td></td><td></td>
<td colspan=9><i>Copyright &copy; 2004-2005 <a href="mailto:webmaster@nucstorm.com">Chunk Lee</a></i></td>
<td colspan=9 align="right"><i><a href="http://www.nucstorm.com" target="_top">www.nucstorm.com</a></i></td>
<td></td><td></td>
</tr>
</table>
<!导航条>
<p align="right"><a href="content1.html">目录</a> <a href="page197.html">上一页</a> <a href="page199.html">下一页</a> <a href="page207.html">下一章</a></p>
</body>
</html>
