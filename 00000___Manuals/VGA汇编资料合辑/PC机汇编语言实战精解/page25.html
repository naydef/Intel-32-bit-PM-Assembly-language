<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<title>第2章 开始设计程序</title>
</head>

<body>
<style type="text/css">
body {
	background-color: #c0c0c0;
}

table {
	background-color: #c0c0c0;
	line-height: 24px;
}
</style>
<!导航条>
<p><a href="content1.html">目录</a> <a href="page24.html">上一页</a> <a href="page26.html">下一页</a> <a href="page27.html">下一章</a></p>
<table border=0 align="center" width=800 frame="box" rules="none">
<!标尺行>
<tr>
<td width=3%></td><td width=6%></td><td width=1%></td> <!左侧空白>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=1%></td><td width=6%></td><td width=3%></td> <!右侧空白>
</tr>
<!页眉行>
<tr height=60 valign="bottom">
<td></td><td></td><td></td>
<td colspan=6><img src="icons/flag.gif"></td><td colspan=4></td><td colspan=6 align="right">第2章 开始设计程序</td> <!章节名>
<td></td><td>-25-</td><td></td> <!页码>
</tr>
<!页眉线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!正文>
<font face="宋体" lang="ZH-CN" size=3>
<tr height=20><td colspan=22></td></tr> <!顶部空白>

<tr>
<td></td><td></td> <!左边距>
<td colspan=3></td>
<td colspan=15>
　　　　DEC  内存单元<br>
执　行：原数据减1，结果仍保存于这个寄存器或内存单元中
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　这条指令和C语言的那个"－－"运算符一样。由于所有段寄存器都不参与运算，所以没有"DEC DS"这样的用法。<br>
　　在程序PROG2－B中我们一开始用BX来保存外循环的计数值，在内循环执行完后，我们用"DEC BX"使得BX中的计数值减1。下面的问题就是看BX是否被减成0。这由新增的JNZ指令完成。
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=3 align="center"><img src="icons/note.gif"></td>
<td colspan=15>
助记符：JNZ（JUMP  IF  NOT  ZERO）<br>
用　途：根据运算结果是否非0来控制转移<br>
格　式：JNZ  目的地址<br>
执　行：若ZF＝0，则转移至目的地址执行指令；若ZF＝1，则继续执行下面的指令
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　新的问题出现了，ZF是什么？是新的寄存器吗？<br>
　　这个问题不会再留到后面讨论了，因为它本身就是个遗留下来的问题。请看第一节内"细看PC机"中的2.2.5，在前文我们刚刚讨论了堆栈指针（SP）寄存器，还留了3个小问题，现在我们就来讨论"标志寄存器"。<br>
　　对于一般数学运算我们不仅要关心运算的结果，同时要关心"运算后果"。以"DEC BX"为例，若BX〉1，则执行一次DEC指令不会使BX减为0，即运算没有造成变量变成0的"后果"；若BX＝1，则执行一次DEC即可造成"BX＝0"的后果。因此对于DEC指令而言，它可以造成两种不同的后果：<br>
　　（1）被减的变量仍大于0；　　　　（2）被减的变量恰好成了0。<br>
　　我们所编的程序并不关心"DEC  BX"的结果是什么，但是要关心"DEC BX"的后果。因为BX被减至0实际意味着外循环的结束。那么运算的后果记录在什么地方呢？<br>
　　在CPU中有一个特殊的16bit寄存器，此寄存器称为"标志寄存器（FLAG Register）"。和通用寄存器、段寄存器不同，它并不用于保存数据，CPU用它某些位的0，1状态来记录运算的后果。它的结构如图2－7所示。
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18 align="center">
<img src="figures/F2_8.gif"><br><font face="楷体_GB2312">图2-7 标志寄存器的结构</font>
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　所用到的各个位的解释都列在表2－1中，其中的ZF位就是我们现在所关心的。ZF被称为"零标志位"（Zero Flag），当某次运算的结果恰好是0时，ZF将被"置位（SET）"，即ZF＝1；否则ZF"复位（RESET）"。JNZ指令根据ZF的状态来转移。
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18 align="center"><font face="楷体_GB2312" size=3>
表2-1  标志寄存器各个位的功能表
</font></td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>标志位</font></td><td colspan=12 align="center"><font size=2>功　能　解　释</font></td><td colspan=2><font size=2>清0</font></td><td colspan=2><font size=2>置1</font></td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>CF</font></td><td colspan=12><font size=2>进位（借位）标志，某次运算有进位或借位时此标志置1</font></td><td colspan=2><font size=2>NC</font></td><td colspan=2><font size=2>CY</font></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>PF</font></td><td colspan=12><font size=2>奇偶标志，若运算结果中为1的位有偶数个此标志置1</font></td><td colspan=2><font size=2>PE</font></td><td colspan=2><font size=2>PO</font></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>AF</font></td><td colspan=12><font size=2>辅助进位标志<sup>*</sup>，记录运算中低4位向高4位或低8位向高8位的进位</font></td><td colspan=2><font size=2>AC</font></td><td colspan=2><font size=2>NA</font></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>ZF</font></td><td colspan=12><font size=2>零标志，若运算结果等于0此标志置1</font></td><td colspan=2><font size=2>ZR</font></td><td colspan=2><font size=2>NZ</font></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>SF</font></td><td colspan=12><font size=2>符号标志，运算结果为负数此标志置1</font></td><td colspan=2><font size=2>NG</font></td><td colspan=2><font size=2>PL</font></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>TF</font></td><td colspan=12><font size=2>陷井标志，当此标志位置1后CPU处于单步执行方式</font></td><td colspan=2><font size=2>-</font></td><td colspan=2><font size=2>-</font></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>IF</font></td><td colspan=12><font size=2>中断标志，此标志置1时允许CPU响应中断，置0时将屏蔽中断<sup>**</sup></font></td><td colspan=2><font size=2>EI</font></td><td colspan=2><font size=2>DI</font></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>DF</font></td><td colspan=12><font size=2>方向标志，用于控制串处理指令的步进方向</font></td><td colspan=2><font size=2>DN</font></td><td colspan=2><font size=2>UP</font></td>
<td></td><td></td> <!右边距>
</tr>
<tr>
<td></td><td></td> <!左边距>
<td colspan=2><font size=2>OF</font></td><td colspan=12><font size=2>溢出标志，若运算发生溢出时此标志置1</font></td><td colspan=2><font size=2>OV</font></td><td colspan=2><font size=2>NV</font></td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18><font face="楷体_GB2312" size=2>
注：* 也称为半进位标志； ** 对不可屏蔽中断（NMI）没有影响
</font></td>
<td></td><td></td> <!右边距>
</tr>

</font>
<!页脚线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!页脚>
<tr height=60 valign="top">
<td></td><td></td>
<td colspan=9><i>Copyright &copy; 2004-2005 <a href="mailto:webmaster@nucstorm.com">Chunk Lee</a></i></td>
<td colspan=9 align="right"><i><a href="http://www.nucstorm.com" target="_top">www.nucstorm.com</a></i></td>
<td></td><td></td>
</tr>
</table>
<!导航条>
<p align="right"><a href="content1.html">目录</a> <a href="page24.html">上一页</a> <a href="page26.html">下一页</a> <a href="page27.html">下一章</a></p>
</body>
</html>

