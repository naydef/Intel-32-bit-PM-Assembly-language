<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<title>第11章 更高级的技术</title>
</head>

<body>
<style type="text/css">
body {
	background-color: #c0c0c0;
}

table {
	background-color: #c0c0c0;
	line-height: 24px;
}
</style>
<!导航条>
<p><a href="content1.html">目录</a> <a href="page302.html">上一页</a> <a href="page304.html">下一页</a> <a href="page328.html">附录A</a></p>
<table border=0 align="center" width=800 frame="box" rules="none">
<!标尺行>
<tr>
<td width=3%></td><td width=6%></td><td width=1%></td> <!左侧空白>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=1%></td><td width=6%></td><td width=3%></td> <!右侧空白>
</tr>

<!页眉行>
<tr height=60 valign="bottom">
<td></td><td></td><td></td>
<td colspan=6><img src="icons/flag.gif"></td><td colspan=4></td><td colspan=6 align="right">第11章 更高级的技术</td> <!章节名>
<td></td><td>-303-</td><td></td> <!页码>
</tr>
<!页眉线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!正文>
<font face="宋体" lang="ZH-CN" size=3>
<tr height=20><td colspan=22></td></tr> <!顶部空白>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
按下[PrtSc]键，此时屏幕上所有的文字都被保存在一个名为TEXT.SCR的文本文件中，使用TYPE命令或EDIT程序可以观察到抓到的内容。<br>
　　（3）08H中断<br>
　　前面讨论定时器时对08H中断做过介绍，这个中断是定时电路的通道0控制，每一秒中产生18.2次，每两次之间的时间间隔为55Ms。它的服务程序控制着BIOS数据区中的一个双字变量，每执行一次就将这个变量加1。同时它还控制着软盘驱动器的马达，软驱工作完毕后总要隔2秒钟左右才会停转，这2秒的延时就是由08H中断控制的。<br>
　　重新编制08H中断服务程序可以很方便地完成精确定时，最重要的是用这种方法定时不需要CPU循环等待。如果把CPU比作一个正在忙于工作的人，那么这个"人"实际上是一边做本职工作一边每隔55Ms看一下"表"。当到达预定时间后他会转去做另一件事，然后再回来继续工作。请大家仔细分析下面这个程序的运行情况：
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=2>
TIMER.ASM<br>
code<br>
<br>
<br>
main<br>
<br>
counter<br>
attrib<br>
old08<br>
new08:<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</td>
<td colspan=2>
<br>
segment<br>
assume<br>
org<br>
proc<br>
jmp<br>
db<br>
db<br>
dd<br>
<br>
push<br>
push<br>
push<br>
push<br>
<br>
pushf<br>
call<br>
<br>
mov<br>
inc<br>
cmp<br>
jnz<br>
<br>
mov<br>
mov<br>
mov<br>
<br>
mov
</td>
<td colspan=5>
<br>
<br>
cs:code,ds:code<br>
100h<br>
near<br>
install<br>
?<br>
0<br>
?<br>
<br>
ax<br>
cx<br>
es<br>
di<br>
<br>
<br>
dword ptr cs:[old08]<br>
<br>
al,cs:[counter]<br>
al<br>
al,18<br>
exit<br>
<br>
ax,0b800h<br>
es,ax<br>
di,0<br>
<br>
al,cs:[attrib]
</td>
<td colspan=9>
<br>
<br>
<br>
<br>
<br>
；跳转至驻留程序的安装部分<br>
；定义一个计数器<br>
；字符属性字节<br>
；原08H中断向量<br>
<br>
；保存寄存器<br>
<br>
<br>
<br>
<br>
；标志寄存器入栈<br>
；调用原08H中断服务程序<br>
<br>
；取得计数值<br>
；计数值加1<br>
；计到1秒钟了吗？<br>
；未到1秒钟，转EXIT退出服务程序<br>
<br>
；ES:DI向显示缓冲区<br>
<br>
<br>
<br>
；取得属性字节
</td>
<td></td><td></td> <!右边距>
</tr>

</font>

<!页脚线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!页脚>
<tr height=60 valign="top">
<td></td><td></td>
<td colspan=9><i>Copyright &copy; 2004-2005 <a href="mailto:webmaster@nucstorm.com">Chunk Lee</a></i></td>
<td colspan=9 align="right"><i><a href="http://www.nucstorm.com" target="_top">www.nucstorm.com</a></i></td>
<td></td><td></td>
</tr>
</table>
<!导航条>
<p align="right"><a href="content1.html">目录</a> <a href="page302.html">上一页</a> <a href="page304.html">下一页</a> <a href="page328.html">附录A</a></p>
</body>
</html>
