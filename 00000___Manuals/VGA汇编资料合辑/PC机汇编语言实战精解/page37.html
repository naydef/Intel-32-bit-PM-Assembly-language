<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<title>第3章 中断调用与子程序</title>
</head>

<body>
<style type="text/css">
body {
	background-color: #c0c0c0;
}

table {
	background-color: #c0c0c0;
	line-height: 24px;
}
</style>
<!导航条>
<p><a href="content1.html">目录</a> <a href="page36.html">上一页</a> <a href="page38.html">下一页</a> <a href="page45.html">下一章</a></p>
<table border=0 align="center" width=800 frame="box" rules="none">
<!标尺行>
<tr>
<td width=3%></td><td width=6%></td><td width=1%></td> <!左侧空白>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=1%></td><td width=6%></td><td width=3%></td> <!右侧空白>
</tr>

<!页眉行>
<tr height=60 valign="bottom">
<td></td><td></td><td></td>
<td colspan=6><img src="icons/flag.gif"></td><td colspan=4></td><td colspan=6 align="right">第3章 中断调用与子程序</td> <!章节名>
<td></td><td>-37-</td><td></td> <!页码>
</tr>
<!页眉线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>

<!正文>
<font face="宋体" lang="ZH-CN" size=3>
<tr height=20><td colspan=22></td></tr> <!顶部空白>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　图3－1反映了SHR指令执行的情况。从图中可以看出，假如利用SHR指令将8位二进制数10110110右移2位，应该得到00101101，同时标志寄存器中CF位会被置成1。
</td>
<td></td><td></td> <!右边距>
</tr>

<tr align="center">
<td></td><td></td> <!左边距>
<td colspan=18><img src="figures/F3_1.gif"><br><font face="楷体_GB2312">图3-1 SHR指令执行的情况示意图</font></td>
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=3 align="center"><img src="icons/note.gif"></td>
<td colspan=15>
助记符：AND<br>
用　途：将两个数据作"与"逻辑操作<br>
格　式：AND  寄存器，立即数<br>
　　　　AND  寄存器，寄存器<br>
　　　　AND  寄存器，存储单元<br>
　　　　AND  存储单元，寄存器<br>
　　　　AND  存储单元，立即数
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td><!左边距>
<td colspan="18">
　　程序采用的算法并不难理解，为了测试AL中各个位的0、1状态，我们先在BH中放入二进制数10000000，这个数称为"掩模（MASK）"，然后用BH与AL作AND操作。很明显AL中的数据将有7位被"屏敝"，只有和BH中为1的位相对应的数位被保留。若这一位恰好为0，则AND操作的结果就是0，此时ZF标志置位；反之若这一位为1，那么ZF就会复位。用JZ指令依据ZF状态进行转移，分别输出0和1，然后将"掩模"中的"1"向右移动一位，再循环执行前面的测试部分，八次循环后在屏幕上将显示出AL中数据的二进制形式。<br>
　　现在我们把程序中输出数据部分改写成子程序，如PROG4－A所示：
</td>
<td></td><td></td><!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td></td><td></td>
<td colspan=8>PROG4-A</td><td colspan=8></td>
<td></td><td></td><!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td></td><td></td>
<td colspan=8>-a100[Enter]</td><td colspan=8></td>
<td></td><td></td><!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td></td><td></td>
<td colspan=6>
0A3E:0100 MOV AH,01<br>
0A3E:0102 INT 21<br>
0A3E:0104 CALL 010D<br>
0A3E:0107 CMP AL,1B<br>
0A3E:0109 JNZ 0100<br>
0A3E:010B INT 20<br>
0A3E:010D PUSH AX<br>
0A3E:010E MOV DH,AL<br>
0A3E:0110 MOV BH,80<br>
0A3E:0112 MOV CX,0008<br>
0A3E:0115 MOV DL,30<br>
0A3E:0117 MOV BL,DH<br>
0A3E:0119 AND BL,BH<br>
0A3E:011B JZ 011F<br>
0A3E:011D MOV DL,31<br>
0A3E:011F MOV AH,02<br>
0A3E:0121 INT 21
</td>

<td colspan=12>
；选择DOS API的01H功能<br>
；调用21H中断等待键盘输入<br>
；调用位于010DH处的子程序<br>
；判断输入的字符是否为"ESC"<br>
；若输入字符不是"ESC"，则转至0100H处继续接收字符<br>
；若输入字符是"ESC"则结束程序<br>
；子程序开始，保存AX寄存器<br>
；输入字符的ASCII码置入DH寄存器<br>
；BH寄存器置入"掩膜"10000000B<br>
；处理8个数位<br>
；DL寄存器置入字符0的ASCII码30H<br>
；BL寄存器置入输入字符的ASCII码<br>
；将ASCII码与"掩膜"相与<br>
；若结果为0，则转至011F显示字符0<br>
；若结果不为0，则将字符1的ASCII码置入DL寄存器<br>
；选择DOS API的02H功能<br>
；调用21H中断显示DL寄存器中的字符
</td>
</tr>

</font>
<!页脚线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!页脚>
<tr height=60 valign="top">
<td></td><td></td>
<td colspan=9><i>Copyright &copy; 2004-2005 <a href="mailto:webmaster@nucstorm.com">Chunk Lee</a></i></td>
<td colspan=9 align="right"><i><a href="http://www.nucstorm.com" target="_top">www.nucstorm.com</a></i></td>
<td></td><td></td>
</tr>
</table>
<!导航条>
<p align="right"><a href="content1.html">目录</a> <a href="page36.html">上一页</a> <a href="page38.html">下一页</a> <a href="page45.html">下一章</a></p>
</body>
</html>

