<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<title>第4章 奇妙的声音</title>
</head>

<body>
<style type="text/css">
body {
	background-color: #c0c0c0;
}

table {
	background-color: #c0c0c0;
	line-height: 24px;
}
</style>
<!导航条>
<p><a href="content1.html">目录</a> <a href="page74.html">上一页</a> <a href="page76.html">下一页</a> <a href="page80.html">下一章</a></p>
<table border=0 align="center" width=800 frame="box" rules="none">
<!标尺行>
<tr>
<td width=3%></td><td width=6%></td><td width=1%></td> <!左侧空白>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td><td width=5%></td>
<td width=1%></td><td width=6%></td><td width=3%></td> <!右侧空白>
</tr>

<!页眉行>
<tr height=60 valign="bottom">
<td></td><td></td><td></td>
<td colspan=6><img src="icons/flag.gif"></td><td colspan=4></td><td colspan=6 align="right">第4章 奇妙的声音</td> <!章节名>
<td></td><td>-75-</td><td></td> <!页码>
</tr>
<!页眉线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!正文>
<font face="宋体" lang="ZH-CN" size=3>
<tr height=20><td colspan=22></td></tr> <!顶部空白>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
不等于时转移）"。条件转移指令有很多，以后会陆续介绍，现在我们还是回到程序上来。<br>
　　讨论了有关转移指令的一些问题之后，我们还是回到SIREN程序上来。表"ADDR"中定义了两个子过程的入口偏移地址，如果把这两个数据看作是一个数组，那么很明显这相当于C语言中的"指针数组"，它里面存放了两个指向"函数"（子过程）的指针。"OUTMSG"是将要显示在屏幕上的菜单。<br>
　　图4-4给出了SIREN主程序的流程图，程序首先在屏幕上显示出菜单并接收按键，判断按键是否是1或2，若不是则认为选择了"OTHER"，退出程序；若是1或2则将输入的ASCII码转换成数字。字符0－9对应的ASCII码是30H－39H，将ASCII码减去30H就得到数字00H－09H。这个转换方法很常用，值得记住。
</td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18 align="center"><img src="figures/F4_5.gif"><br><font face="楷体_GB2312">图4-4 SIREN主程序流程图</font></td>
<td></td><td></td> <!右边距>
</tr>

<tr>
<td></td><td></td> <!左边距>
<td colspan=18>
　　完成转换后程序需要根据得到的数字在ADDR表中查到与按键相对应的子过程的指针，我们知道[ADDR+0]处的一个字存放了RISE子过程的入口地址，[ADDR+2]处的一个字存放了FALL子过程的地址，因此与按键相对应的子过程入口地址在ADDR表中的位置可以表示成"（K-1）×2"，K就是所按键的ASCII码转换成的数字。当我们按下"1"键，K就是0001H，则（K-1）×2的值就是0000H，在ADDR表中偏移0处存放的正是RISE子过程的偏移地址，我们即可利用间接寻址的方法调用RISE子过程。相应的指令就是CALL ADDR[BX]，BX中存放的就是（K-1）×2的值。<br>
　　对应于MUSIC程序中的"MOV AX，FREQ[BX]"指令，我们可以看出CALL指令的间接寻址用法与MOV等指令并无差别。<br>
　　善于思考的C语言用户恐怕早已明白，这种算法其实就是C语言中用函数指针变量调用函
</td>
<td></td><td></td> <!右边距>
</tr>


</font>

<!页脚线>
<tr valign="top">
<td></td><td colspan=20><hr></td><td></td>
</tr>
<!页脚>
<tr height=60 valign="top">
<td></td><td></td>
<td colspan=9><i>Copyright &copy; 2004-2005 <a href="mailto:webmaster@nucstorm.com">Chunk Lee</a></i></td>
<td colspan=9 align="right"><i><a href="http://www.nucstorm.com" target="_top">www.nucstorm.com</a></i></td>
<td></td><td></td>
</tr>
</table>
<!导航条>
<p align="right"><a href="content1.html">目录</a> <a href="page74.html">上一页</a> <a href="page76.html">下一页</a> <a href="page80.html">下一章</a></p>
</body>
</html>

